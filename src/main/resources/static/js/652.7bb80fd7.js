"use strict";(self["webpackChunkhotel"]=self["webpackChunkhotel"]||[]).push([[652],{652:function(e,t,o){o.r(t),o.d(t,{default:function(){return b}});var a=function(){var e=this,t=e.$createElement,o=e._self._c||t;return o("div",{staticClass:"mapmode"},[o("el-header",{staticStyle:{height:"61px"}},[o("el-menu",{staticClass:"el-menu-homepage",attrs:{mode:"horizontal","background-color":"#1F4B62","text-color":"#fff","active-text-color":"#ffd04b"}},[o("el-tooltip",{staticClass:"item",attrs:{effect:"light",content:"点击回到主页",placement:"bottom"}},[o("el-menu-item",{attrs:{index:"10"},on:{click:function(t){return e.backtoHomepage()}}},[e._v(" 回到主页 ")])],1)],1),o("div",{staticClass:"searchBox",staticStyle:{width:"100%",height:"80px","background-color":"white",padding:"20px","text-align":"left"}},[o("el-form",{staticClass:"demo-form-inline",attrs:{inline:!0,model:e.formInline}},[o("el-form-item",{attrs:{label:"酒店名称"}},[o("el-input",{attrs:{placeholder:"请输入酒店名称"},model:{value:e.formInline.hname,callback:function(t){e.$set(e.formInline,"hname",t)},expression:"formInline.hname"}})],1),o("el-form-item",{attrs:{label:"关键词"}},[o("el-input",{staticStyle:{width:"300px"},attrs:{placeholder:"请输入关键词，如地标、景点等"},model:{value:e.formInline.hotelkeyword,callback:function(t){e.$set(e.formInline,"hotelkeyword",t)},expression:"formInline.hotelkeyword"}})],1),o("el-form-item",[o("el-button",{attrs:{type:"primary"},on:{click:e.onQuery}},[e._v("查询")])],1),o("el-form-item",[o("a",{staticStyle:{color:"#37a9e5"},attrs:{href:"#",onclick:"return false;"},on:{click:function(t){return e.showNearby()}}},[e._v(" 附近搜索 ")])]),o("el-tooltip",{staticClass:"item",attrs:{effect:"dark",content:"点击重置地图中心",placement:"bottom"}},[o("el-form-item",{staticStyle:{clear:"both",float:"right"}},[o("el-button",{attrs:{type:"primary"},on:{click:e.setCenter}},[e._v("重置")])],1)],1)],1)],1)],1),o("el-main",[o("div",{staticClass:"baidumap",attrs:{id:"allmap"}}),o("div",{staticClass:"resultBox",staticStyle:{clear:"both",width:"25%",float:"left","background-color":"white","overflow-y":"auto"}},[0===this.hotellist.length?o("span",[o("h6",{staticStyle:{"font-weight":"bold"}},[e._v("请输入条件查询目标酒店")])]):e._e(),e._l(this.hotellist,(function(t){return o("el-col",{key:t.hotelId},[o("div",{staticClass:"card_wrap"},[o("el-card",{staticStyle:{"text-align":"left"},attrs:{shadow:"hover"}},[o("div",{staticClass:"card_content",staticStyle:{"{\n                    border-right":"1px solid #dadfe6",display:"inline-flex",width:"100%",flex:"1"}},[o("div",{staticClass:"info",staticStyle:{flex:"1","text-align":"left"}},[o("span",[o("h5",{staticStyle:{"font-weight":"bold","font-size":"18px"}},[e._v(e._s(t.hotelTranslatedName))])]),o("span",[o("h6",{staticStyle:{color:"darkgray","font-size":"12px"}},[e._v(e._s(t.addressline1))])]),o("el-rate",{attrs:{colors:e.colors,disabled:!0},model:{value:t.starRating,callback:function(o){e.$set(t,"starRating",o)},expression:"item.starRating"}})],1),o("div",{staticClass:"hotel_link",staticStyle:{clear:"left",flex:"1",float:"bottom","text-align":"right"}},[o("span",[o("h3",{staticStyle:{color:"#f60"}},[e._v("¥"+e._s(t.ratesFrom))])]),o("span",[o("h5",{staticStyle:{color:"#f8c000"}},[e._v(e._s(t.ratingAverage)+"分")])]),o("el-button",{staticClass:"button",attrs:{type:"primary",size:"medium"},on:{click:function(o){return e.setPointCenter(t.longitude,t.latitude)}}},[e._v("查看详情")])],1)])])],1)])}))],2)])],1)},i=[],l=function(){var e=this,t=e.$createElement,o=e._self._c||t;return o("div",[e.hasBmView?e._e():o("div",{ref:"view",staticStyle:{width:"100%",height:"100%"}}),e._t("default")],2)},s=[],n={"bm-map":["click","dblclick","rightclick","rightdblclick","maptypechange","mousemove","mouseover","mouseout","movestart","moving","moveend","zoomstart","zoomend","addoverlay","addcontrol","removecontrol","removeoverlay","clearoverlays","dragstart","dragging","dragend","addtilelayer","removetilelayer","load","resize","hotspotclick","hotspotover","hotspotout","tilesloaded","touchstart","touchmove","touchend","longpress"],"bm-geolocation":["locationSuccess","locationError"],"bm-overview-map":["viewchanged","viewchanging"],"bm-marker":["click","dblclick","mousedown","mouseup","mouseout","mouseover","remove","infowindowclose","infowindowopen","dragstart","dragging","dragend","rightclick"],"bm-polyline":["click","dblclick","mousedown","mouseup","mouseout","mouseover","remove","lineupdate"],"bm-polygon":["click","dblclick","mousedown","mouseup","mouseout","mouseover","remove","lineupdate"],"bm-circle":["click","dblclick","mousedown","mouseup","mouseout","mouseover","remove","lineupdate"],"bm-label":["click","dblclick","mousedown","mouseup","mouseout","mouseover","remove","rightclick"],"bm-info-window":["close","open","maximize","restore","clickclose"],"bm-ground":["click","dblclick"],"bm-autocomplete":["onconfirm","onhighlight"],"bm-point-collection":["click","mouseover","mouseout"]};function r(e,t){const o=t||n[this.$options.name];o&&o.forEach((t=>{const o="on"===t.slice(0,2),a=o?t.slice(2):t,i=this.$listeners[a];i&&e.addEventListener(t,i.fns)}))}const c=e=>Object.prototype.toString.call(e).slice(8,-1);var m={name:"bm-map",props:{ak:{type:String},center:{type:[Object,String]},zoom:{type:Number},minZoom:{type:Number},maxZoom:{type:Number},highResolution:{type:Boolean,default:!0},mapClick:{type:Boolean,default:!0},mapType:{type:String},dragging:{type:Boolean,default:!0},scrollWheelZoom:{type:Boolean,default:!1},doubleClickZoom:{type:Boolean,default:!0},keyboard:{type:Boolean,default:!0},inertialDragging:{type:Boolean,default:!0},continuousZoom:{type:Boolean,default:!0},pinchToZoom:{type:Boolean,default:!0},autoResize:{type:Boolean,default:!0},theme:{type:Array},mapStyle:{type:Object}},watch:{center(e,t){const{map:o,zoom:a}=this;"String"===c(e)&&e!==t&&o.centerAndZoom(e,a)},"center.lng"(e,t){const{BMap:o,map:a,zoom:i,center:l}=this;e!==t&&e>=-180&&e<=180&&a.centerAndZoom(new o.Point(e,l.lat),i)},"center.lat"(e,t){const{BMap:o,map:a,zoom:i,center:l}=this;e!==t&&e>=-74&&e<=74&&a.centerAndZoom(new o.Point(l.lng,e),i)},zoom(e,t){const{map:o}=this;e!==t&&e>=3&&e<=19&&o.setZoom(e)},minZoom(e){const{map:t}=this;t.setMinZoom(e)},maxZoom(e){const{map:t}=this;t.setMaxZoom(e)},highResolution(){this.reset()},mapClick(){this.reset()},mapType(e){const{map:t}=this;t.setMapType(o.g[e])},dragging(e){const{map:t}=this;e?t.enableDragging():t.disableDragging()},scrollWheelZoom(e){const{map:t}=this;e?t.enableScrollWheelZoom():t.disableScrollWheelZoom()},doubleClickZoom(e){const{map:t}=this;e?t.enableDoubleClickZoom():t.disableDoubleClickZoom()},keyboard(e){const{map:t}=this;e?t.enableKeyboard():t.disableKeyboard()},inertialDragging(e){const{map:t}=this;e?t.enableInertialDragging():t.disableInertialDragging()},continuousZoom(e){const{map:t}=this;e?t.enableContinuousZoom():t.disableContinuousZoom()},pinchToZoom(e){const{map:t}=this;e?t.enablePinchToZoom():t.disablePinchToZoom()},autoResize(e){const{map:t}=this;e?t.enableAutoResize():t.disableAutoResize()},theme(e){const{map:t}=this;t.setMapStyle({styleJson:e})},"mapStyle.features":{handler(e,t){const{map:o,mapStyle:a}=this,{style:i,styleJson:l}=a;o.setMapStyle({styleJson:l,features:e,style:i})},deep:!0},"mapStyle.style"(e,t){const{map:o,mapStyle:a}=this,{features:i,styleJson:l}=a;o.setMapStyle({styleJson:l,features:i,style:e})},"mapStyle.styleJson":{handler(e,t){const{map:o,mapStyle:a}=this,{features:i,style:l}=a;o.setMapStyle({styleJson:e,features:i,style:l})},deep:!0},mapStyle(e){const{map:t,theme:o}=this;!o&&t.setMapStyle(e)}},methods:{setMapOptions(){const{map:e,minZoom:t,maxZoom:a,mapType:i,dragging:l,scrollWheelZoom:s,doubleClickZoom:n,keyboard:r,inertialDragging:c,continuousZoom:m,pinchToZoom:p,autoResize:h}=this;t&&e.setMinZoom(t),a&&e.setMaxZoom(a),i&&e.setMapType(o.g[i]),l?e.enableDragging():e.disableDragging(),s?e.enableScrollWheelZoom():e.disableScrollWheelZoom(),n?e.enableDoubleClickZoom():e.disableDoubleClickZoom(),r?e.enableKeyboard():e.disableKeyboard(),c?e.enableInertialDragging():e.disableInertialDragging(),m?e.enableContinuousZoom():e.disableContinuousZoom(),p?e.enablePinchToZoom():e.disablePinchToZoom(),h?e.enableAutoResize():e.disableAutoResize()},init(e){if(this.map)return;let t=this.$refs.view;for(let r of this.$slots.default||[])r.componentOptions&&"bm-view"===r.componentOptions.tag&&(this.hasBmView=!0,t=r.elm);const o=new e.Map(t,{enableHighResolution:this.highResolution,enableMapClick:this.mapClick});this.map=o;const{setMapOptions:a,zoom:i,getCenterPoint:l,theme:s,mapStyle:n}=this;s?o.setMapStyle({styleJson:s}):o.setMapStyle(n),a(),r.call(this,o),o.reset(),o.centerAndZoom(l(),i),this.$emit("ready",{BMap:e,map:o})},getCenterPoint(){const{center:e,BMap:t}=this;switch(c(e)){case"String":return e;case"Object":return new t.Point(e.lng,e.lat);default:return new t.Point}},initMap(e){this.BMap=e,this.init(e)},getMapScript(){if(o.g.BMap)return o.g.BMap._preloader?o.g.BMap._preloader:Promise.resolve(o.g.BMap);{const e=this.ak||this._BMap().ak;return o.g.BMap={},o.g.BMap._preloader=new Promise(((t,a)=>{o.g._initBaiduMap=function(){t(o.g.BMap),o.g.document.body.removeChild(i),o.g.BMap._preloader=null,o.g._initBaiduMap=null};const i=document.createElement("script");o.g.document.body.appendChild(i),i.src=`https://api.map.baidu.com/api?v=2.0&ak=${e}&callback=_initBaiduMap`})),o.g.BMap._preloader}},reset(){const{getMapScript:e,initMap:t}=this;e().then(t)}},mounted(){this.reset()},data(){return{hasBmView:!1}}},p=m,h=o(1001),d=(0,h.Z)(p,l,s,!1,null,null,null);d.exports;function u(){const e="XwQ5DxG6RDb6W80kBn4YF1eETZxQloYo",t="https://api.map.baidu.com/api?v=2.0&ak="+e+"&s=1&callback=onBMapCallback";return new Promise(((e,o)=>{if("undefined"!==typeof BMap)return e(BMap),!0;window.onBMapCallback=function(){console.log("百度地图脚本初始化成功..."),e(BMap)};let a=document.createElement("script");a.setAttribute("type","text/javascript"),a.setAttribute("src",t),document.body.appendChild(a)}))}var g={name:"mapmode",data(){return{map:"",points:[],markers:[],infos:[],labels:[],pageNo:1,pageSize:147,colors:["#99A9BF","#F7BA2A","#ff4c25"],pointSingle:[],mode_value:"mapmode",hotellist:[],formInline:{hname:"",hotelkeyword:""},searchFlag:!1,queryId:""}},created(){"null"===this.$route.params.hotelId||(this.queryId=this.$route.params.hotelId,this.findSingleHotel())},async mounted(){await u(),this.initMap()},methods:{initMap(){this.map=new BMap.Map("allmap");var e=new BMap.Point(104.07231,30.663467);this.map.centerAndZoom(e,12),this.map.enableScrollWheelZoom(!0),this.map.addControl(new BMap.NavigationControl),this.map.addControl(new BMap.ScaleControl),this.map.addControl(new BMap.OverviewMapControl({isOpen:!0,anchor:"BMAP_ANCHOR_BOTTOM_RIGHT"})),this.map.addControl(new BMap.MapTypeControl),window.map=this.map;var t=[];window.markers=t;var o=[];window.infos=o;var a=1;window.cpage=a},backtoHomepage(){this.$router.push("/homepage")},onQuery(){const e=this;""===this.formInline.hotelname&&""===this.formInline.hotelkeyword?this.openNull():this.$axios({url:"/api/cdhotel/getHotelByInfo",method:"GET",params:{hname:e.formInline.hname,info:e.formInline.hotelkeyword}}).then((t=>{0===t.data.data.length?(e.openEmpty(),e.hotellist=[],e.clearOverlays()):(e.hotellist=t.data.data,e.showMarker())})).catch((e=>{console.log(e,"err")}))},findSingleHotel(){const e=this;this.$axios({url:"/api/cdhotel/getById/"+e.queryId,method:"GET"}).then((t=>{e.hotellist=t.data.data})).catch((e=>{console.log(e,"err")}));var t=function(){e.showMarker()};setTimeout(t,2e3)},setCenter(){var e=new BMap.Point(104.10194,30.65984);this.map.centerAndZoom(e,12)},showNearby(){this.setPointCenter(104.10194,30.65984);var e=new BMap.Point(104.10194,30.65984),t=new BMap.Circle(e,1e3,{strokeColor:"blue",strokeWeight:2,strokeOpacity:.5});this.map.addOverlay(t),this.map.centerAndZoom(e,16)},showMarker(){this.clearOverlays();for(var e=new BMap.Icon(hotelmarker,new BMap.Size(48,48)),t=0;t<this.hotellist.length;t++){var o=new BMap.Point(this.hotellist[t].longitude,this.hotellist[t].latitude);this.points.push(o);var a=new BMap.Marker(this.points[t],{icon:e});this.markers.push(a);var i=new BMap.Label(this.hotellist[t].hotelTranslatedName,{offset:new BMap.Size(9,-20)});i.setStyle({display:"none",color:"black",fontSize:"14px",height:"20px",lineHeight:"20px",textAlign:"center"}),this.markers[t].setLabel(i),this.map.addOverlay(this.markers[t]),this.markers[t].addEventListener("mouseover",(function(e){var t=this.getLabel();t.setStyle({display:"block"})})),this.markers[t].addEventListener("mouseout",(function(e){var t=this.getLabel();t.setStyle({display:"none"})}));var l="<div style='margin: 0;font-family: 微软雅黑;width: 300px; height: 200px'><b class='iw_poi_title'>酒店详情</b><img style='float:right;margin:auto;flex: 1' id='imgDemo' src='"+this.hotellist[t].photo1+"' width='100%' height='100%'/><div class='iw_poi_content' style='clear: both;font-size: 26px;float: right;color: red;'>¥"+this.hotellist[t].ratesFrom+"</div><div class='iw_poi_content' style='clear: both;font-size: 18px;float: right;color: #f0ad4e;'>"+this.hotellist[t].ratingAverage+"分</div><div class='iw_poi_content' style='font-weight: bold;font-size: 18px'>"+this.hotellist[t].hotelTranslatedName+"</div><div class='iw_poi_content' style='font-size: 12px;color: gray'>"+this.hotellist[t].hotelName+"</div><div class='iw_poi_content' style='font-size: 14px;color: orangered;font-weight: bold'>"+this.hotellist[t].starRating+"星级</div><div class='iw_poi_content' style='font-size: 14px;'>地址:"+this.hotellist[t].addressline1+"</div></div></div>",s=new BMap.InfoWindow(l);this.infos.push(s);let n=this.infos[t];this.markers[t].addEventListener("click",(function(){this.openInfoWindow(n)})),i.addEventListener("click",(function(){this.openInfoWindow(n)})),this.markers[t].isOpen&&(i.hide(),this.openInfoWindow(n)),this.setZoom()}},clearOverlays(){let e=this.map.getOverlays();for(var t=0;t<e.length;t++)this.map.removeOverlay(e[t]);this.map.clearOverlays(),this.points=[],this.markers=[],this.infos=[],this.labels=[]},setZoom(){var e=this.map.getViewport(this.points),t=e.zoom,o=e.center;this.map.centerAndZoom(o,t)},setPointCenter(e,t){var o=new BMap.Point(e,t),a=[];a.push(o);var i=this.map.getViewport(a),l=i.zoom,s=i.center;this.map.centerAndZoom(s,l)},openNull(){this.$message.error("请输入查询条件")},openEmpty(){this.$message.warning("未查询到信息")}},watch:{mode_value(){"listmode"===this.mode_value&&this.$router.push("/search")}}},y=g,f=(0,h.Z)(y,a,i,!1,null,"7901143a",null),b=f.exports}}]);
//# sourceMappingURL=652.7bb80fd7.js.map